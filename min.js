const a=(e,t)=>e.dispatchEvent(new Event(t)),b=({r:e,...t})=>{let n={},r={},o={};Object.entries(t).forEach((([e,t])=>e.startsWith("__")?n[e.substring(2)]=t:e.startsWith("_")?r[e.substring(1)]=t:o[e]=t));const c=document.createElement(e||"div");Object.entries(o).forEach((([e,t])=>c.setAttribute(e.replaceAll("_","-"),t)));const s=e=>c.addEventListener(...e);return Object.entries(n).forEach((e=>{s(["mount",()=>window.addEventListener(...e)]),s(["unmount",()=>window.removeEventListener(...e)])})),Object.entries(r).forEach(s),c};let d={},f=[],g=0,h=0;export const render=(e,t,n)=>{if(!e||void 0===t)return;const r="string"!=typeof e?e:document?.querySelector(e);if("function"==typeof t)return render(r,{r:t},n);if(Array.isArray(t))return t.forEach((e=>render(r,e)));if("object"!=typeof t)return r.innerHTML+=t;const o="function"==typeof t?.r;o&&(h=0);const c=o?t?.r({uid:"_"+g,...t}):t,s="object"==typeof c&&!Array.isArray(c),{c:d,...i}=s?c:{r:"span",c:c};let u=null;if(n){const e=r.parentNode,t=[...e.children].indexOf(r);a(r,"unmount"),r.querySelectorAll("*").forEach((e=>a(e,"unmount"))),e.replaceChild(b(i),r),u=e.children[t]}else r.append(b(i)),u=r.lastChild;o&&(f[g++]=[u,t]),render(u,d),a(u,"mount")};export const store=e=>{const t=g,n=`${t}-${h++}`;d[n]||(d[n]=e);return[d[n],e=>{d[n]="function"==typeof e?e(d[n]):e,g=t,render(...f[t],!0),g=f.length}]};export const memo=(e,t=[])=>{const n=`${g}-${h++}`;return d[n]&&!d[n].dependencies.some(((e,n)=>e!==t[n]))||(d[n]={value:e(),dependencies:t}),d[n].value};