const a=(e,t)=>e.dispatchEvent(new Event(t)),b=({r:e,...t})=>{let r={},n={},o={};Object.entries(t).forEach((([e,t])=>e.startsWith("__")?r[e.substring(2)]=t:e.startsWith("_")?n[e.substring(1)]=t:o[e]=t));const c=document.createElement(e||"div");Object.entries(o).forEach((([e,t])=>c.setAttribute(e.replaceAll("_","-"),t)));const s=([e,t])=>c.addEventListener(e,t);return Object.entries(r).forEach((([e,t])=>{s(["mount",()=>window.addEventListener(e,t)]),s(["unmount",()=>window.removeEventListener(e,t)])})),Object.entries(n).forEach(s),c};let c={},d=[],f=0,g=0;export const render=(e,t,r)=>{if(!e||void 0===t)return;const n="string"!=typeof e?e:document?.querySelector(e);if("function"==typeof t)return render(n,{r:t},r);if(Array.isArray(t))return t.forEach((e=>render(n,e)));if("object"!=typeof t)return n.innerHTML+=t;const{r:o,...c}=t,s="function"==typeof o;s&&(g=0);const i=s?o({uid:"_"+f,...c}):t,{c:u,...l}="object"!=typeof i||Array.isArray(i)?{r:"span",c:i}:i;let h=null;if(r){const e=n.parentNode,t=[...e.children].indexOf(n);a(n,"unmount"),n.querySelectorAll("*").forEach((e=>a(e,"unmount"))),e.replaceChild(b(l),n),h=e.children[t]}else n.append(b(l)),h=n.lastChild;s&&(d[f++]=[h,t]),void 0!==u&&render(h,u),a(h,"mount")};export const store=e=>{const t=f,r=`${t}-${g++}`;c[r]||(c[r]=e);return[c[r],e=>{c[r]="function"==typeof e?e(c[r]):e,f=t,render(...d[t],!0),f=d.length}]};export const memo=(e,t)=>{const r=`${f}-${g++}`,n=Array.isArray(t)?t:[];return c[r]&&!c[r].h.some(((e,t)=>e!==n[t]))||(c[r]={value:e(),h:n}),c[r].value};